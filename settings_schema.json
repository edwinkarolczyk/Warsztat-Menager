{
  "magazyn": {
    "type": "object",
    "title": "Magazyn",
    "properties": {
      "require_reauth": {
        "type": "boolean",
        "title": "Wymagaj re-autoryzacji przy PZ/WZ",
        "default": true
      },
      "rounding": {
        "type": "object",
        "title": "Zaokrąglanie",
        "properties": {
          "mb_precision": {
            "type": "integer",
            "title": "Precyzja dla 'mb'",
            "minimum": 0,
            "maximum": 6,
            "default": 3
          },
          "enforce_integer_for_szt": {
            "type": "boolean",
            "title": "Wymuszaj liczby całkowite dla 'szt'",
            "default": true
          }
        }
      },
      "round_quantities": { "type": "boolean", "default": true },
      "default_unit": {
        "type": "string",
        "default": "szt",
        "enum": ["szt", "mb"]
      },
      "dim_in_mm": { "type": "boolean", "default": true },
      "len_in_mb": { "type": "boolean", "default": true },
      "pz": {
        "type": "object",
        "properties": {
          "prefix": { "type": "string", "default": "PZ" },
          "width": {
            "type": "integer",
            "default": 5,
            "minimum": 1,
            "maximum": 10
          },
          "reset_daily": { "type": "boolean", "default": false },
          "seq_file": {
            "type": "string",
            "default": "data/magazyn/_seq_pz.json"
          }
        }
      },
      "auto_rezerwacje": { "type": "boolean", "default": true },
      "rezerwacje_only_started_orders": { "type": "boolean", "default": true },
      "rezerwacje_positive_only": { "type": "boolean", "default": true },
      "alert_procent": {
        "type": "integer",
        "default": 10,
        "minimum": 1,
        "maximum": 100
      },
      "low_stock_auto_order": { "type": "boolean", "default": true },
      "perms": {
        "type": "object",
        "properties": {
          "brygadzista": {
            "type": "object",
            "properties": {
              "edit": { "type": "boolean", "default": true },
              "pz": { "type": "boolean", "default": false }
            }
          },
          "magazynier": {
            "type": "object",
            "properties": {
              "edit": { "type": "boolean", "default": true },
              "pz": { "type": "boolean", "default": true }
            }
          }
        }
      }
    }
  },
  "orders": {
    "type": "object",
    "title": "Ustawienia zleceń",
    "properties": {
      "id_width": { "type": "integer", "default": 4, "minimum": 3, "maximum": 6 },
      "types": {
        "type": "object",
        "properties": {
          "ZW": {
            "type": "object",
            "properties": {
              "enabled": { "type": "boolean", "default": true },
              "label": { "type": "string", "default": "Zlecenie wewnętrzne" },
              "prefix": { "type": "string", "default": "ZW-" },
              "reserve_by_default": { "type": "boolean", "default": false },
              "allow_products": { "type": "boolean", "default": true },
              "bom_required": { "type": "boolean", "default": true },
              "statuses": {
                "type": "array",
                "items": { "type": "string" },
                "default": ["nowe","w trakcie","zakończone","anulowane"]
              }
            },
            "required": ["enabled", "label", "prefix", "statuses"]
          },
          "ZN": {
            "type": "object",
            "properties": {
              "enabled": { "type": "boolean", "default": true },
              "label": { "type": "string", "default": "Zlecenie na narzędzie" },
              "prefix": { "type": "string", "default": "ZN-" },
              "reserve_by_default": { "type": "boolean", "default": true },
              "allow_old_tools": { "type": "boolean", "default": true },
              "tools_range": {
                "type": "array",
                "items": { "type": "integer" },
                "default": [500,1000]
              },
              "statuses": {
                "type": "array",
                "items": { "type": "string" },
                "default": ["projekt","w budowie","ostrzenie","naprawa","odbiór","na produkcji","anulowane"]
              }
            },
            "required": ["enabled", "label", "prefix", "statuses"]
          },
          "ZM": {
            "type": "object",
            "properties": {
              "enabled": { "type": "boolean", "default": true },
              "label": { "type": "string", "default": "Naprawa/awaria maszyny" },
              "prefix": { "type": "string", "default": "ZM-" },
              "reserve_by_default": { "type": "boolean", "default": true },
              "require_description": { "type": "boolean", "default": true },
              "urgency_colors": {
                "type": "object",
                "default": {
                  "wysoki": "blink_red",
                  "normalny": "yellow",
                  "niski": "green"
                }
              },
              "statuses": {
                "type": "array",
                "items": { "type": "string" },
                "default": ["awaria zgłoszona","diagnoza","w naprawie","test","sprawdzona","zakończone","anulowane"]
              }
            },
            "required": ["enabled", "label", "prefix", "statuses"]
          }
        },
        "required": ["ZW", "ZN", "ZM"]
      }
    },
    "required": ["id_width", "types"]
  },
  "tabs": [
  {
    "id": "system",
    "title": "System",
    "description": "Ustawienia ogólne programu (język, motyw, ścieżki, auto-aktualizacje).",
    "tooltip": "Zmiany w tym dziale wpływają globalnie na cały program.",
    "icon": "settings",
    "groups": [
      {
        "id": "ui",
        "label": "Wygląd i język",
        "tooltip": "Konfiguracja motywu kolorystycznego oraz języka interfejsu.",
        "fields": [
          {
            "key": "ui.theme",
            "label": "Motyw interfejsu",
            "type": "enum",
            "enum": ["dark", "warm"],
            "default": "dark",
            "help": "Wybrany motyw kolorystyczny aplikacji (default = motyw główny, warm = alternatywny, christmas = świąteczny)."
          },
          {
            "key": "ui.accent",
            "label": "Kolor akcentu",
            "type": "string",
            "default": "red",
            "help": "Kolor akcentu stosowany w przyciskach i nagłówkach."
          },
          {
            "key": "ui.language",
            "label": "Język interfejsu",
            "type": "enum",
            "enum": ["pl", "en"],
            "default": "pl",
            "help": "Kod języka używany w interfejsie (np. pl lub en)."
          },
          {
            "key": "ui.always_searchbar",
            "label": "Zawsze pokazuj wyszukiwarkę",
            "type": "bool",
            "default": true,
            "help": "Wymusza widoczność paska wyszukiwania w panelu głównym."
          }
        ]
      },
      {
        "id": "auth",
        "label": "Logowanie i bezpieczeństwo",
        "tooltip": "Ustawienia sposobu logowania użytkowników do aplikacji.",
        "fields": [
          {
            "key": "auth.required",
            "label": "Wymagaj logowania",
            "type": "bool",
            "default": true,
            "help": "Blokuje dostęp do aplikacji bez poprawnego logowania."
          },
          {
            "key": "auth.session_timeout_min",
            "label": "Limit bezczynności (minuty)",
            "type": "int",
            "min": 1,
            "default": 30,
            "help": "Po tylu minutach bezczynności użytkownik zostanie wylogowany."
          },
          {
            "key": "auth.pin_length",
            "label": "Długość PIN",
            "type": "int",
            "min": 4,
            "max": 8,
            "default": 4,
            "help": "Liczba cyfr wymagana podczas logowania PIN-em."
          },
          {
            "key": "auth.pinless_brygadzista",
            "label": "Logowanie brygadzisty bez PIN",
            "type": "bool",
            "default": false,
            "help": "Umożliwia brygadziście logowanie bez podawania PIN-u."
          }
        ]
      },
      {
        "title": "Ścieżki i start",
        "fields": [
          {
            "type": "text",
            "key": "system.data_path",
            "label": "Ścieżka danych",
            "default": "C:\\\\wm\\\\data",
            "placeholder": "np. C:\\\\wm\\\\data"
          },
          {
            "type": "boolean",
            "key": "system.start_on_dashboard",
            "label": "Startuj na panel główny",
            "default": true
          }
        ]
      },
      {
        "id": "backup",
        "label": "Kopie zapasowe",
        "tooltip": "Lokalne i zdalne kopie zapasowe konfiguracji.",
        "fields": [
          {
            "key": "backup.folder",
            "label": "Katalog kopii lokalnych",
            "type": "string",
            "default": "backup_wersji",
            "help": "Ścieżka (względna lub bezwzględna) dla lokalnych kopii pliku config.json."
          },
          {
            "key": "backup.keep_last",
            "label": "Liczba kopii do zachowania",
            "type": "int",
            "min": 1,
            "default": 10,
            "help": "Maksymalna liczba ostatnich kopii przechowywanych na dysku."
          },
          {
            "key": "backup.cloud.url",
            "label": "Adres magazynu kopii (chmura)",
            "type": "string",
            "default": "",
            "help": "Adres endpointu (np. WebDAV/SFTP), do którego wysyłane są kopie."
          },
          {
            "key": "backup.cloud.username",
            "label": "Login do magazynu kopii",
            "type": "string",
            "default": "",
            "help": "Nazwa użytkownika używana podczas wysyłania kopii do chmury."
          },
          {
            "key": "backup.cloud.password",
            "label": "Hasło do magazynu kopii",
            "type": "string",
            "widget": "password",
            "default": "",
            "help": "Hasło uwierzytelniające połączenie z magazynem kopii."
          },
          {
            "key": "backup.cloud.folder",
            "label": "Katalog w magazynie kopii",
            "type": "string",
            "default": "",
            "help": "Podkatalog w zdalnym magazynie, w którym zapisywane są kopie."
          }
        ]
      },
      {
        "id": "updates",
        "label": "Aktualizacje",
        "tooltip": "Parametry automatycznego sprawdzania i wdrażania aktualizacji.",
        "fields": [
          {
            "key": "updates.auto",
            "label": "Automatycznie sprawdzaj aktualizacje",
            "type": "bool",
            "default": true,
            "help": "Przy starcie aplikacji sprawdzaj dostępność nowej wersji."
          },
          {
            "key": "updates.remote",
            "label": "Repozytorium zdalne",
            "type": "string",
            "default": "origin",
            "help": "Nazwa zdalnego repozytorium Git wykorzystywanego do aktualizacji."
          },
          {
            "key": "updates.branch",
            "label": "Gałąź aktualizacji",
            "type": "string",
            "default": "Rozwiniecie",
            "help": "Gałąź, z której pobierane są aktualizacje programu."
          },
          {
            "key": "updates.push_branch",
            "label": "Gałąź wysyłania zmian",
            "type": "string",
            "default": "Rozwiniecie",
            "help": "Gałąź używana przy wysyłaniu zmian do repozytorium."
          }
        ]
      },
      {
        "id": "secrets",
        "label": "Dostęp administracyjny",
        "tooltip": "Poufne dane administratora potrzebne do resetów i awaryjnego dostępu.",
        "fields": [
          {
            "key": "secrets.admin_pin",
            "label": "PIN administratora",
            "type": "string",
            "widget": "password",
            "default": "",
            "help": "PIN wykorzystywany przy operacjach administracyjnych (np. reset haseł)."
          }
        ]
      }
    ],
    "sections": []
  },
  {
    "id": "uzytkownicy",
    "title": "Użytkownicy",
    "description": "Role i uprawnienia użytkowników. (Edycja listy w subzakładce).",
    "tooltip": "Konfiguruj dostęp do modułów i status kont.",
    "icon": "users",
    "subtabs": [
      {
        "id": "moj_profil",
        "title": "Mój profil",
        "description": "Podgląd danych zalogowanego użytkownika.",
        "groups": [
          {
            "title": "Informacje",
            "fields": [
              {
                "type": "info",
                "key": "profile.info",
                "text": "Dane z bieżącej sesji. Edycje w 'Zarządzanie (lista)'."
              }
            ]
          }
        ]
      },
      {
        "id": "uprawnienia",
        "title": "Uprawnienia",
        "description": "Konfiguracja ról i dostępu.",
        "groups": [
          {
            "title": "Role i dostęp",
            "fields": []
          }
        ]
      },
      {
        "id": "zarzadzanie_lista",
        "title": "Zarządzanie (lista)",
        "description": "Lista użytkowników.",
        "groups": [
          {
            "title": "Lista kont",
            "fields": []
          }
        ]
      }
    ],
    "sections": []
  },
  {
    "id": "hala",
    "title": "Hala",
    "description": "Widok hali: tło JPEG, siatka 20 cm = 4 px (1 kratka = 0,05 m), numer hali wyświetlany na maszynie.",
    "tooltip": "Pozycje maszyn zapisywane są do pliku maszyn.json.",
    "icon": "layout",
    "sections": []
  },
  {
    "id": "narzedzia",
    "title": "Narzędzia",
    "description": "Konfiguracja typów, statusów i zadań. Nowe NN (001–499) w diagramach zaznaczamy na żółto.",
    "tooltip": "Definiuj typy/statusy i reguły zachowania w module Narzędzia.",
    "icon": "wrench",
    "subtabs": [
      {
        "id": "typy_statusy",
        "title": "Typy i statusy",
        "description": "Definicje typów narzędzi, statusów i list zadań w statusach.",
        "sections": []
      },
      {
        "id": "reguly",
        "title": "Reguły",
        "description": "Automatyczne wymuszenia (np. zmiana na „sprawne” zaznacza [x] istniejące zadania).",
        "sections": []
      }
    ],
    "sections": []
  },
  {
    "id": "zlecenia",
    "title": "Zlecenia",
    "description": "Ustawienia modułu zleceń: statusy, kreator (osobne okno, ciemny motyw).",
    "tooltip": "Statusy są wybierane z listy (Combobox) podczas edycji zlecenia.",
    "icon": "clipboard-list",
    "subtabs": [
      {
        "id": "statusy",
        "title": "Statusy",
        "description": "Predefiniowane statusy zleceń (dwuklik w edycji otwiera listę wyboru).",
        "sections": []
      },
      {
        "id": "kreator",
        "title": "Kreator",
        "description": "Opcje kreatora dodawania zlecenia (Toplevel, zgodny motyw WM).",
        "sections": []
      }
    ],
    "sections": []
  },
  {
    "id": "magazyn",
    "title": "Magazyn",
    "description": "Ustawienia magazynu i BOM. Stany aktualizowane w czasie rzeczywistym.",
    "tooltip": "Definiuj progi alertów i struktury produktów (BOM) w katalogu data/produkty/.",
    "icon": "boxes",
    "subtabs": [
      {
        "id": "ustawienia_magazynu",
        "title": "Ustawienia magazynu",
        "description": "Progi alertów (np. 10%), lokalizacja danych, integracja ze zleceniami.",
        "groups": [
          {
            "label": "Rezerwacje i alerty",
            "tooltip": "Konfiguracja progów alertów magazynu oraz automatycznych rezerwacji.",
            "fields": [
              {
                "key": "magazyn_rezerwacje",
                "label": "Włącz rezerwacje magazynowe",
                "type": "bool",
                "default": true,
                "description": "Steruje tworzeniem rezerwacji pozycji na potrzeby zleceń."
              },
              {
                "key": "progi_alertow_pct",
                "label": "Progi alertów magazynowych [%]",
                "type": "array",
                "value_type": "float",
                "default": [
                  100.0
                ],
                "description": "Lista wartości procentowych uruchamiających alerty stanów magazynowych."
              },
              {
                "key": "progi_alertow_surowce",
                "label": "Progi alertów dla surowców",
                "type": "dict",
                "value_type": "float",
                "default": {},
                "description": "Mapowanie nazwy surowca na indywidualny próg alertu (%)."
              }
            ]
          }
        ]
      },
      {
        "id": "produkty_bom",
        "title": "Produkty (BOM)",
        "description": "Struktury produktów oraz powiązania półproduktów/części.",
        "groups": [
          {
            "label": "Katalog produktów",
            "tooltip": "Ścieżka katalogu oraz opcje automatycznego odświeżania kartotek produktów.",
            "fields": [
              {
                "key": "produkty_dir",
                "label": "Folder produktów (BOM)",
                "type": "path",
                "widget": "dir",
                "default": "data/produkty/",
                "description": "Katalog przechowujący definicje struktur produktów."
              },
              {
                "key": "produkty_auto_sync",
                "label": "Automatyczna synchronizacja produktów",
                "type": "bool",
                "default": false,
                "description": "Po zaznaczeniu katalog produktów będzie automatycznie monitorowany i odświeżany."
              }
            ]
          },
          {
            "label": "Katalog półproduktów",
            "fields": [
              {
                "key": "polprodukty_dir",
                "label": "Folder półproduktów",
                "type": "path",
                "widget": "dir",
                "default": "data/polprodukty/",
                "description": "Katalog z definicjami półproduktów wykorzystywanych w BOM."
              },
              {
                "key": "polprodukty_auto_sync",
                "label": "Automatyczna synchronizacja półproduktów",
                "type": "bool",
                "default": false,
                "description": "Monitoruj katalog półproduktów i automatycznie odświeżaj listę w programie."
              },
              {
                "key": "surowce_file",
                "label": "Plik z listą surowców",
                "type": "path",
                "widget": "file",
                "default": "data/magazyn/surowce.json",
                "description": "Źródło danych o dostępnych surowcach wykorzystywanych w BOM."
              }
            ]
          }
        ]
      }
    ],
    "sections": []
  },
  {
    "id": "zamowienia",
    "title": "Zamówienia",
    "description": "Obsługa braków materiałowych: po wykryciu braku zapytać „Czy zamówić brakujący materiał?”.",
    "tooltip": "Twórz zamówienia materiałów po detekcji braków.",
    "icon": "shopping-cart",
    "groups": [
      {
        "label": "Aktywacja modułu",
        "fields": [
          {
            "key": "orders.enabled",
            "label": "Włącz obsługę zamówień materiałowych",
            "type": "bool",
            "default": true,
            "description": "Przełącznik główny decydujący o dostępności modułu zamówień."
          }
        ]
      },
      {
        "label": "Parametry procesu",
        "tooltip": "Definiuj kroki kreatora, typy i statusy wykorzystywane podczas pracy z zamówieniami.",
        "fields": [
          {
            "key": "orders.enabled_steps",
            "label": "Aktywne kroki kreatora zamówienia",
            "type": "array",
            "value_type": "string",
            "default": [
              "typ",
              "kontekst",
              "pozycje",
              "dostawca",
              "terminy_status",
              "podsumowanie"
            ],
            "description": "Wpisz jeden etap na linię w kolejności wykonywania."
          },
          {
            "key": "orders.types",
            "label": "Definicje typów zamówień",
            "type": "dict",
            "default": {},
            "description": "Mapa kodu typu zamówienia na jego konfigurację (prefiks, statusy, itp.)."
          },
          {
            "key": "orders.statuses",
            "label": "Statusy zamówień",
            "type": "array",
            "value_type": "string",
            "default": [
              "draft",
              "oczekuje_wyslania",
              "wyslane",
              "w_realizacji",
              "dostarczone",
              "zamkniete",
              "anulowane"
            ],
            "description": "Etapy cyklu życia zamówienia; każdy status w osobnym wierszu."
          }
        ]
      },
      {
        "label": "Identyfikatory i lokalizacja",
        "fields": [
          {
            "key": "orders.id_width",
            "label": "Szerokość numeru zamówienia",
            "type": "int",
            "default": 4,
            "min": 1,
            "max": 8,
            "description": "Minimalna liczba cyfr w automatycznie nadawanym identyfikatorze."
          },
          {
            "key": "orders.auto_id_format",
            "label": "Format automatycznego ID",
            "type": "string",
            "default": "ORD-{YYYYMMDD}-{HHMMSS}",
            "description": "Wzorzec wykorzystywany przy generowaniu numeru zamówienia."
          },
          {
            "key": "orders.data_dir",
            "label": "Folder na zamówienia",
            "type": "path",
            "widget": "dir",
            "default": "data/zamowienia",
            "description": "Katalog, w którym zapisywane są pliki z zamówieniami."
          },
          {
            "key": "orders.default_supplier",
            "label": "Domyślny dostawca",
            "type": "string",
            "default": "",
            "description": "Nazwa dostawcy proponowana automatycznie w kreatorze zamówień."
          }
        ]
      },
      {
        "label": "Uprawnienia",
        "tooltip": "Role, które mogą tworzyć, przyjmować i anulować zamówienia.",
        "fields": [
          {
            "key": "orders.permissions.create",
            "label": "Role uprawnione do tworzenia",
            "type": "array",
            "value_type": "string",
            "default": [
              "brygadzista",
              "kierownik",
              "admin"
            ],
            "description": "Podaj role po jednej w linii."
          },
          {
            "key": "orders.permissions.receive",
            "label": "Role uprawnione do przyjęcia dostawy",
            "type": "array",
            "value_type": "string",
            "default": [
              "magazynier",
              "kierownik",
              "admin"
            ],
            "description": "Podaj role po jednej w linii."
          },
          {
            "key": "orders.permissions.cancel",
            "label": "Role uprawnione do anulowania",
            "type": "array",
            "value_type": "string",
            "default": [
              "kierownik",
              "admin"
            ],
            "description": "Podaj role po jednej w linii."
          }
        ]
      }
    ]
  },
  {
    "id": "aktualizacje",
    "title": "Aktualizacje & Kopie",
    "description": "Kopie zapasowe, przywracanie i wersjonowanie. Operacje wykonywane z dedykowanego modułu.",
    "tooltip": "Konfiguracja/Opis – same operacje uruchamiane są poza tym panelem.",
    "icon": "history",
    "sections": []
  },
  {
    "id": "tests",
    "title": "[DEV] Testy",
    "description": "Zakładka testowa – tylko do użytku deweloperskiego.",
    "tooltip": "Opcje techniczne używane tylko podczas prac deweloperskich.",
    "devOnly": true,
    "icon": "beaker",
    "sections": []
  }
]
}
